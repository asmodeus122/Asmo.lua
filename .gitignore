-- STEAL A BRAINROT - SCRIPT COMPLETO COM MOD MENU BONITO

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local PhysicsService = game:GetService("PhysicsService")

local player = Players.LocalPlayer
local char = player.Character or player.CharacterAdded:Wait()
local root = char:WaitForChild("HumanoidRootPart")
local hum = char:WaitForChild("Humanoid")

local autoTP = false
local autoSteal = false
local noclipOn = false
local delaySteal = 1

-- Criar grupo de colisão 'NoCollide' se não existir
pcall(function()
	if not PhysicsService:CollisionGroupExists("NoCollide") then
		PhysicsService:CreateCollisionGroup("NoCollide")
		PhysicsService:CollisionGroupSetCollidable("NoCollide", "Default", false)
	end
end)

-- Noclip com CollisionGroups
RunService.Stepped:Connect(function()
	if noclipOn and char and char:FindFirstChild("HumanoidRootPart") then
		for _, part in pairs(char:GetDescendants()) do
			if part:IsA("BasePart") then
				part.CanCollide = false
				PhysicsService:SetPartCollisionGroup(part, "NoCollide")
			end
		end
	end
end)

-- Pulo infinito melhorado
local maxExtraJumps = 3
local extraJumps = 0
local jumpCooldown = 0.4
local lastJumpTime = 0

local function canJump()
	return (tick() - lastJumpTime) >= jumpCooldown
end

UserInputService.JumpRequest:Connect(function()
	local char = player.Character
	if char and char:FindFirstChild("Humanoid") then
		local hum = char.Humanoid
		local state = hum:GetState()
		if state == Enum.HumanoidStateType.Freefall or state == Enum.HumanoidStateType.Jumping or state == Enum.HumanoidStateType.Landed then
			if canJump() and extraJumps < maxExtraJumps then
				hum:ChangeState(Enum.HumanoidStateType.Jumping)
				extraJumps += 1
				lastJumpTime = tick()
			end
		elseif state == Enum.HumanoidStateType.Running or state == Enum.HumanoidStateType.Landed then
			extraJumps = 0
		end
	end
end)

-- ESP Brainrots
local espActive = false
function highlightBrainrots()
	for _, obj in pairs(workspace:GetChildren()) do
		if obj:IsA("Model") and obj.Name:lower():find("brainrot") and obj:FindFirstChild("HumanoidRootPart") then
			if espActive and not obj:FindFirstChild("Highlight") then
				local hl = Instance.new("Highlight", obj)
				hl.FillColor = Color3.new(1, 0, 0)
				hl.OutlineColor = Color3.new(1, 1, 1)
				hl.FillTransparency = 0.3

				local billboard = Instance.new("BillboardGui", obj)
				billboard.Name = "ESPName"
				billboard.Size = UDim2.new(0, 100, 0, 20)
				billboard.Adornee = obj:FindFirstChild("HumanoidRootPart")
				billboard.AlwaysOnTop = true

				local label = Instance.new("TextLabel", billboard)
				label.Size = UDim2.new(1, 0, 1, 0)
				label.BackgroundTransparency = 1
				label.TextColor3 = Color3.new(1, 0, 0)
				label.Text = obj.Name
				label.TextScaled = true
				label.Font = Enum.Font.GothamBold
			elseif not espActive then
				local hl = obj:FindFirstChild("Highlight")
				if hl then hl:Destroy() end
				local espName = obj:FindFirstChild("ESPName")
				if espName then espName:Destroy() end
			end
		end
	end
end

-- Rodar o ESP a cada 2 segundos para manter atualizado
task.spawn(function()
	while true do
		task.wait(2)
		highlightBrainrots()
	end
end)

-- Buscar brainrot mais próximo
function getClosestBrainrot()
	local closest, dist = nil, math.huge
	for _, obj in pairs(workspace:GetChildren()) do
		if obj:IsA("Model") and obj.Name:lower():find("brainrot") and obj:FindFirstChild("HumanoidRootPart") then
			local d = (obj.HumanoidRootPart.Position - root.Position).Magnitude
			if d < dist then
				closest = obj
				dist = d
			end
		end
	end
	return closest
end

-- Auto TP
task.spawn(function()
	while true do
		task.wait(0.2)
		if autoTP then
			local target = getClosestBrainrot()
			if target then
				local hrp = target:FindFirstChild("HumanoidRootPart")
				if hrp then
					root.CFrame = hrp.CFrame * CFrame.new(0, 3, -3)
				end
			end
		end
	end
end)

-- Auto Steal
task.spawn(function()
	while true do
		if autoSteal then
			local target = getClosestBrainrot()
			if target then
				local prompt = target:FindFirstChildWhichIsA("ProximityPrompt", true)
				if prompt then
					fireproximityprompt(prompt)
				end
			end
			task.wait(delaySteal)
		else
			task.wait(0.5)
		end
	end
end)

-- GUI
local gui = Instance.new("ScreenGui")
gui.Name = "StealBrainrotMenu"
gui.ResetOnSpawn = false
gui.Parent = game.CoreGui

local menuFrame = Instance.new("Frame", gui)
menuFrame.Size = UDim2.new(0, 220, 0, 320)
menuFrame.Position = UDim2.new(0, 10, 0, 100)
menuFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
menuFrame.BackgroundTransparency = 0.15
menuFrame.BorderSizePixel = 0
menuFrame.ClipsDescendants = true
menuFrame.Active = true
menuFrame.Draggable = true

local title = Instance.new("TextLabel", menuFrame)
title.Size = UDim2.new(1, 0, 0, 50)
title.BackgroundTransparency = 1
title.Text = "Steal Brainrot Menu"
title.Font = Enum.Font.GothamBold
title.TextSize = 20
title.TextColor3 = Color3.new(1, 1, 1)

local function createToggleButton(text, yPos, getState, toggleFunc)
	local btn = Instance.new("TextButton", menuFrame)
	btn.Size = UDim2.new(0, 200, 0, 35)
	btn.Position = UDim2.new(0, 10, 0, yPos)
	btn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
	btn.BorderSizePixel = 0
	btn.Font = Enum.Font.GothamBold
	btn.TextSize = 16
	btn.TextColor3 = Color3.new(1,1,1)
	btn.Text = text .. " : OFF"
	btn.AutoButtonColor = false

	local function updateButton()
		if getState() then
			btn.BackgroundColor3 = Color3.fromRGB(50, 150, 50)
			btn.Text = text .. " : ON"
		else
			btn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
			btn.Text = text .. " : OFF"
		end
	end

	btn.MouseEnter:Connect(function()
		btn.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
	end)
	btn.MouseLeave:Connect(function()
		updateButton()
	end)

	btn.MouseButton1Click:Connect(function()
		toggleFunc()
		updateButton()
	end)

	updateButton()
	return btn
end

local espBtn = createToggleButton("ESP Brainrots", 60, 
	function() return espActive end, 
	function() 
		espActive = not espActive 
		highlightBrainrots()
	end)

local noclipBtn = createToggleButton("Noclip", 105, 
	function() return noclipOn end, 
	function() noclipOn = not noclipOn end)

local autoTpBtn = createToggleButton("Auto Teleport", 150, 
	function() return autoTP end, 
	function() autoTP = not autoTP end)

local autoStealBtn = createToggleButton("Auto Steal", 195, 
	function() return autoSteal end, 
	function() autoSteal = not autoSteal end)

local delayLabel = Instance.new("TextLabel", menuFrame)
delayLabel.Size = UDim2.new(0, 200, 0, 30)
delayLabel.Position = UDim2.new(0, 10, 0, 240)
delayLabel.BackgroundTransparency = 1
delayLabel.Font = Enum.Font.GothamBold
delayLabel.TextSize = 16
delayLabel.TextColor3 = Color3.new(1,1,1)
delayLabel.Text = "Delay: " .. delaySteal .. "s"

local delayPlusBtn = Instance.new("TextButton", menuFrame)
delayPlusBtn.Size = UDim2.new(0, 45, 0, 30)
delayPlusBtn.Position = UDim2.new(0, 10, 0, 275)
delayPlusBtn.Text = "+"
delayPlusBtn.Font = Enum.Font.GothamBold
delayPlusBtn.TextSize = 20
delayPlusBtn.BackgroundColor3 = Color3.fromRGB(40, 120, 40)
delayPlusBtn.TextColor3 = Color3.new(1,1,1)
delayPlusBtn.BorderSizePixel = 0

local delayMinusBtn = Instance.new("TextButton", menuFrame)
delayMinusBtn.Size = UDim2.new(0, 45, 0, 30)
delayMinusBtn.Position = UDim2.new(0, 65, 0, 275)
delayMinusBtn.Text = "-"
delayMinusBtn.Font = Enum.Font.GothamBold
delayMinusBtn.TextSize = 20
delayMinusBtn.BackgroundColor3 = Color3.fromRGB(120, 40, 40)
delayMinusBtn.TextColor3 = Color3.new(1,1,1)
delayMinusBtn.BorderSizePixel = 0

delayPlusBtn.MouseButton1Click:Connect(function()
	delaySteal = delaySteal + 0.5
	delayLabel.Text = "Delay: " .. string.format("%.1f", delaySteal) .. "s"
end)

delayMinusBtn.MouseButton1Click:Connect(function()
	delaySteal = math.max(0.2, delaySteal - 0.5)
	delayLabel.Text = "Delay: " .. string.format("%.1f", delaySteal) .. "s"
end)
